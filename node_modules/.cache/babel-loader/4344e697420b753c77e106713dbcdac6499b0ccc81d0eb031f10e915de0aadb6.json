{"ast":null,"code":"import React from\"react\";import{userOperations}from\"@/lib/supabaseOperations\";import{supabase}from\"@/supabase\";import{Avatar,AvatarFallback}from\"@/components/ui/avatar\";import{Button}from\"@/components/ui/button\";import{Users,ChevronRight}from\"lucide-react\";import{ScrollArea}from\"@/components/ui/scroll-area\";import{motion}from\"framer-motion\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function FriendsList(_ref){let{user}=_ref;const[friends,setFriends]=React.useState([]);const[loading,setLoading]=React.useState(true);const navigate=useNavigate();React.useEffect(()=>{const fetchFriends=async()=>{if(!(user!==null&&user!==void 0&&user.id)){setFriends([]);setLoading(false);return;}// Buscar amizades aceitas na tabela friendships\nconst{data:friendshipRows,error}=await supabase.from('friendships').select('friend_id').eq('user_id',user.id).eq('status','accepted');console.log('[DEBUG] friendshipRows:',friendshipRows);if(error)console.error('[DEBUG] Erro friendships:',error);if(!friendshipRows||friendshipRows.length===0){setFriends([]);setLoading(false);return;}const friendIds=friendshipRows.map(f=>f.friend_id);console.log('[DEBUG] friendIds:',friendIds);// Buscar dados dos amigos na tabela users\nconst{data:friendUsers,error:userError}=await supabase.from('users').select('*').in('id',friendIds);console.log('[DEBUG] friendUsers:',friendUsers);if(userError)console.error('[DEBUG] Erro users:',userError);setFriends(friendUsers||[]);setLoading(false);};fetchFriends();},[user===null||user===void 0?void 0:user.id]);const handleRemoveFriend=async friendId=>{// Remove amizade da tabela friendships\nawait supabase.from('friendships').delete().eq('user_id',user.id).eq('friend_id',friendId);await supabase.from('friendships').delete().eq('user_id',friendId).eq('friend_id',user.id);setFriends(prev=>prev.filter(f=>f.id!==friendId));};const getInitials=name=>{if(!name)return\"U\";return name.split(\" \").map(n=>n[0]).join(\"\").toUpperCase().slice(0,2);};const handleFriendClick=friend=>{navigate(\"/friend/\".concat(friend.id,\"/decks\"));};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-3\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-white\",children:\"Meus Amigos\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[\"(\",friends.length,\")\"]})]}),/*#__PURE__*/_jsx(ScrollArea,{className:\"h-64 rounded-lg border border-gray-800\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full\",children:\"Carregando...\"}):friends.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-full text-center p-4\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-12 h-12 text-gray-600 mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"Nenhum amigo adicionado\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"p-2 space-y-1\",children:friends.map(friend=>/*#__PURE__*/_jsx(motion.div,{whileHover:{x:4},whileTap:{scale:0.98},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 hover:bg-gray-800 rounded-lg group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-1 cursor-pointer\",onClick:()=>handleFriendClick(friend),children:[/*#__PURE__*/_jsx(Avatar,{className:\"h-10 w-10\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold\",children:getInitials(friend.display_name||friend.email)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-white truncate\",children:friend.display_name||friend.email}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 truncate\",children:friend.email})]}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5 text-gray-500 group-hover:text-orange-500 transition-colors flex-shrink-0\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"icon\",onClick:()=>handleRemoveFriend(friend.id),className:\"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-900/20 hover:text-red-400\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})},friend.id))})})]});}","map":{"version":3,"names":["React","userOperations","supabase","Avatar","AvatarFallback","Button","Users","ChevronRight","ScrollArea","motion","useNavigate","jsx","_jsx","jsxs","_jsxs","FriendsList","_ref","user","friends","setFriends","useState","loading","setLoading","navigate","useEffect","fetchFriends","id","data","friendshipRows","error","from","select","eq","console","log","length","friendIds","map","f","friend_id","friendUsers","userError","in","handleRemoveFriend","friendId","delete","prev","filter","getInitials","name","split","n","join","toUpperCase","slice","handleFriendClick","friend","concat","className","children","div","whileHover","x","whileTap","scale","onClick","display_name","email","variant","size"],"sources":["C:/Users/Lucas Araujo/Desktop/supabase/DeckMaster/src/components/user/FriendsList.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { userOperations } from \"@/lib/supabaseOperations\";\r\nimport { supabase } from \"@/supabase\";\r\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Users, ChevronRight } from \"lucide-react\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\n\r\nexport default function FriendsList({ user }) {\r\n  const [friends, setFriends] = React.useState([]);\r\n  const [loading, setLoading] = React.useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  React.useEffect(() => {\r\n    const fetchFriends = async () => {\r\n      if (!user?.id) {\r\n        setFriends([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      // Buscar amizades aceitas na tabela friendships\r\n      const { data: friendshipRows, error } = await supabase\r\n        .from('friendships')\r\n        .select('friend_id')\r\n        .eq('user_id', user.id)\r\n        .eq('status', 'accepted');\r\n      console.log('[DEBUG] friendshipRows:', friendshipRows);\r\n      if (error) console.error('[DEBUG] Erro friendships:', error);\r\n      if (!friendshipRows || friendshipRows.length === 0) {\r\n        setFriends([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      const friendIds = friendshipRows.map(f => f.friend_id);\r\n      console.log('[DEBUG] friendIds:', friendIds);\r\n      // Buscar dados dos amigos na tabela users\r\n      const { data: friendUsers, error: userError } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .in('id', friendIds);\r\n      console.log('[DEBUG] friendUsers:', friendUsers);\r\n      if (userError) console.error('[DEBUG] Erro users:', userError);\r\n      setFriends(friendUsers || []);\r\n      setLoading(false);\r\n    };\r\n    fetchFriends();\r\n  }, [user?.id]);\r\n\r\n  const handleRemoveFriend = async (friendId) => {\r\n    // Remove amizade da tabela friendships\r\n    await supabase\r\n      .from('friendships')\r\n      .delete()\r\n      .eq('user_id', user.id)\r\n      .eq('friend_id', friendId);\r\n    await supabase\r\n      .from('friendships')\r\n      .delete()\r\n      .eq('user_id', friendId)\r\n      .eq('friend_id', user.id);\r\n    setFriends(prev => prev.filter(f => f.id !== friendId));\r\n  };\r\n\r\n  const getInitials = (name) => {\r\n    if (!name) return \"U\";\r\n    return name.split(\" \").map(n => n[0]).join(\"\").toUpperCase().slice(0, 2);\r\n  };\r\n\r\n  const handleFriendClick = (friend) => {\r\n    navigate(`/friend/${friend.id}/decks`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <div className=\"flex items-center gap-2 mb-3\">\r\n        <Users className=\"w-4 h-4 text-gray-400\" />\r\n        <h3 className=\"font-semibold text-white\">Meus Amigos</h3>\r\n        <span className=\"text-xs text-gray-500\">({friends.length})</span>\r\n      </div>\r\n\r\n      <ScrollArea className=\"h-64 rounded-lg border border-gray-800\">\r\n        {loading ? (\r\n          <div className=\"flex items-center justify-center h-full\">Carregando...</div>\r\n        ) : friends.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center h-full text-center p-4\">\r\n            <Users className=\"w-12 h-12 text-gray-600 mb-2\" />\r\n            <p className=\"text-gray-500 text-sm\">Nenhum amigo adicionado</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"p-2 space-y-1\">\r\n            {friends.map((friend) => (\r\n              <motion.div key={friend.id} whileHover={{ x: 4 }} whileTap={{ scale: 0.98 }}>\r\n                <div className=\"flex items-center justify-between p-3 hover:bg-gray-800 rounded-lg group\">\r\n                  <div className=\"flex items-center gap-3 flex-1 cursor-pointer\" onClick={() => handleFriendClick(friend)}>\r\n                    <Avatar className=\"h-10 w-10\">\r\n                      <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold\">\r\n                        {getInitials(friend.display_name || friend.email)}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div className=\"text-left flex-1 min-w-0\">\r\n                      <p className=\"font-medium text-white truncate\">{friend.display_name || friend.email}</p>\r\n                      <p className=\"text-xs text-gray-500 truncate\">{friend.email}</p>\r\n                    </div>\r\n                    <ChevronRight className=\"w-5 h-5 text-gray-500 group-hover:text-orange-500 transition-colors flex-shrink-0\" />\r\n                  </div>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    onClick={() => handleRemoveFriend(friend.id)}\r\n                    className=\"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-900/20 hover:text-red-400\"\r\n                  >\r\n                    🗑️\r\n                  </Button>\r\n                </div>\r\n              </motion.div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </ScrollArea>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}