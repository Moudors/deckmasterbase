{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{DropdownMenu,DropdownMenuContent,DropdownMenuTrigger,DropdownMenuSeparator}from\"@/components/ui/dropdown-menu\";import{Tabs,TabsContent,TabsList,TabsTrigger}from\"@/components/ui/tabs\";import{Button}from\"@/components/ui/button\";import{Input}from\"@/components/ui/input\";import{Label}from\"@/components/ui/label\";import{Avatar,AvatarFallback}from\"@/components/ui/avatar\";import{User,Users,Copy,Check,UserPlus,LogOut,MessageSquare,Edit}from\"lucide-react\";import{motion,AnimatePresence}from\"framer-motion\";import{Alert,AlertDescription}from\"@/components/ui/alert\";import{Badge}from\"@/components/ui/badge\";import MessagesPanel from\"./MessagesPanel\";import FriendsList from\"./FriendsList\";import ProfileEdit from\"./ProfileEdit\";import{signOut}from\"@/authSupabase\";import{userOperations,messageOperations}from\"@/lib/supabaseOperations\";import{useNavigate}from\"react-router-dom\";import{useQuery,useQueryClient}from\"@tanstack/react-query\";import{useAuthState}from\"@/hooks/useAuthState\";import{useUserProfile}from\"@/hooks/useUserProfile\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserMenu(){const[authUser]=useAuthState();const{profile:currentUser,loading:profileLoading}=useUserProfile(authUser);const queryClient=useQueryClient();const[friendId,setFriendId]=useState(\"\");const[showAddFriend,setShowAddFriend]=useState(false);const[showEditProfile,setShowEditProfile]=useState(false);const[showMessagesPanel,setShowMessagesPanel]=useState(false);const[copied,setCopied]=useState(false);const[error,setError]=useState(null);console.log('üîÑ UserMenu - authUser:',authUser);console.log('üÜî UserMenu - authUser.id:',authUser===null||authUser===void 0?void 0:authUser.id);console.log('üîÑ UserMenu - authUser.email:',authUser===null||authUser===void 0?void 0:authUser.email);console.log('üë§ UserMenu - currentUser:',currentUser);console.log('‚è≥ UserMenu - profileLoading:',profileLoading);const[success,setSuccess]=useState(null);const navigate=useNavigate();// ‚úÖ Current User - Agora usando useUserProfile hook em vez de query antiga\n// const { data: user } = useQuery({\n//   queryKey: [\"currentUser\", auth.currentUser?.uid],\n//   queryFn: async () => {\n//     if (!auth.currentUser) return null;\n//     const userRef = doc(db, \"users\", auth.currentUser.uid);\n//     const docSnap = await getDoc(userRef);\n//     return docSnap.exists() ? { id: docSnap.id, ...docSnap.data() } : null;\n//   },\n//   staleTime: 5 * 60 * 1000, // Cache 5 minutos\n//   refetchInterval: 5 * 60 * 1000, // Polling a cada 5 minutos (ao inv√©s de tempo real)\n//   enabled: !!auth.currentUser,\n// });\n// Usar currentUser do hook useUserProfile\nconst user=currentUser;console.log('üéØ UserMenu - user final:',user);console.log('üîç UserMenu - display_name:',user===null||user===void 0?void 0:user.display_name);console.log('üîç UserMenu - email:',user===null||user===void 0?void 0:user.email);// Buscar usernames da tabela 'usernames'\nconst{data:allUsernames=[]}=useQuery({queryKey:[\"allUsernames\"],queryFn:async()=>{return await userOperations.getAllUsernames();},staleTime:30*60*1000,// Cache 30 minutos\ngcTime:60*60*1000// Garbage collect ap√≥s 1 hora\n});// ‚úÖ Messages - S√≥ busca quando painel est√° ABERTO (economia de ~3.600 leituras/hora quando fechado)\nconst{data:messages=[]}=useQuery({queryKey:[\"messages\",user===null||user===void 0?void 0:user.id],queryFn:async()=>{if(!(user!==null&&user!==void 0&&user.id))return[];return await messageOperations.getMessagesByRecipient(user.id);},staleTime:2*60*1000,// Cache 2 minutos\nrefetchInterval:showMessagesPanel?30*1000:false,// Polling apenas quando painel aberto\nenabled:!!(user!==null&&user!==void 0&&user.id)&&showMessagesPanel// S√ì busca se painel est√° aberto\n});const unreadCount=messages.filter(m=>!m.read).length;const handleCopyId=()=>{const idToCopy=(user===null||user===void 0?void 0:user.username)||(user===null||user===void 0?void 0:user.uuid)||(user===null||user===void 0?void 0:user.id);if(idToCopy){navigator.clipboard.writeText(idToCopy);setCopied(true);setTimeout(()=>setCopied(false),2000);}};const handleAddFriend=async()=>{console.log('[DEBUG] allUsernames:',JSON.stringify(allUsernames,null,2));console.log('[DEBUG] searchInput:',friendId.trim());setError(null);setSuccess(null);const searchInput=friendId.trim();if(!searchInput){setError(\"Por favor, insira um ID ou username\");return;}try{var _user$friends;console.log('[DEBUG] Tentando encontrar usu√°rio:',{id:friendId.trim(),username:friendId.trim().toLowerCase()});const searchLower=searchInput.toLowerCase();const friendUsername=allUsernames.find(u=>u.id.toLowerCase()===searchLower);console.log('[DEBUG] Resultado friendUsername:',friendUsername);if(!friendUsername){setError(\"Usu\\xE1rio n\\xE3o encontrado: \\\"\".concat(searchInput,\"\\\"\"));return;}if(friendUsername.uid===user.id){setError(\"Voc√™ n√£o pode adicionar a si mesmo\");return;}if((_user$friends=user.friends)!==null&&_user$friends!==void 0&&_user$friends.includes(friendUsername.uid)){setError(\"Este usu√°rio j√° est√° na sua lista de amigos\");return;}await messageOperations.sendMessage({recipient_id:friendUsername.uid,sender_id:user.id,sender_name:user.display_name||user.full_name||user.email,content:\"\".concat(user.display_name||user.full_name||user.email,\" quer adicionar voc\\xEA como amigo.\"),type:\"friend_request\",status:\"pending\",created_at:new Date().toISOString()});setSuccess(\"Solicita√ß√£o de amizade enviada com sucesso!\");setFriendId(\"\");}catch(err){console.error(err);setError(\"Erro: \".concat(err.message||\"N√£o foi poss√≠vel enviar a solicita√ß√£o\"));}};const getInitials=name=>{if(!name)return\"U\";return name.split(\" \").map(n=>n[0]).join(\"\").toUpperCase().slice(0,2);};const displayUserName=(user===null||user===void 0?void 0:user.display_name)||(user===null||user===void 0?void 0:user.full_name);return/*#__PURE__*/_jsxs(DropdownMenu,{children:[/*#__PURE__*/_jsx(DropdownMenuTrigger,{asChild:true,children:/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",className:\"relative h-10 w-10 rounded-full border-2 border-gray-700 hover:border-orange-500 transition-colors\",children:[unreadCount>0&&/*#__PURE__*/_jsx(Badge,{className:\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 bg-orange-500 text-white text-xs\",children:unreadCount}),/*#__PURE__*/_jsx(Avatar,{className:\"h-9 w-9\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-to-br from-orange-500 to-purple-600 text-white font-semibold\",children:getInitials(displayUserName||(user===null||user===void 0?void 0:user.email))})})]})}),/*#__PURE__*/_jsxs(DropdownMenuContent,{className:\"w-96 bg-gray-900 border-gray-800 text-white p-4\",align:\"end\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3 mb-4\",children:[/*#__PURE__*/_jsx(Avatar,{className:\"h-12 w-12\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-to-br from-orange-500 to-purple-600 text-white font-semibold text-lg\",children:getInitials(displayUserName||(user===null||user===void 0?void 0:user.email))})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-white truncate\",children:displayUserName}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 truncate\",children:user===null||user===void 0?void 0:user.email}),(user===null||user===void 0?void 0:user.bio)&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1 line-clamp-2\",children:user.bio}),(user===null||user===void 0?void 0:user.role)===\"admin\"&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-1 px-2 py-0.5 bg-orange-500/20 text-orange-400 text-xs rounded-full\",children:\"Admin\"})]})]}),/*#__PURE__*/_jsx(DropdownMenuSeparator,{className:\"bg-gray-800 mb-4\"}),/*#__PURE__*/_jsxs(Tabs,{defaultValue:\"profile\",className:\"w-full\",onValueChange:value=>{// Ativa busca de mensagens APENAS quando aba √© aberta\nsetShowMessagesPanel(value===\"messages\");},children:[/*#__PURE__*/_jsxs(TabsList,{className:\"grid w-full grid-cols-3 bg-gray-800\",children:[/*#__PURE__*/_jsxs(TabsTrigger,{value:\"profile\",className:\"data-[state=active]:bg-gray-700\",children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 mr-1\"}),\"Perfil\"]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"friends\",className:\"data-[state=active]:bg-gray-700\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-4 h-4 mr-1\"}),\"Amigos\"]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"messages\",className:\"data-[state=active]:bg-gray-700 relative\",children:[/*#__PURE__*/_jsx(MessageSquare,{className:\"w-4 h-4 mr-1\"}),\"Mensagens\",unreadCount>0&&/*#__PURE__*/_jsx(Badge,{className:\"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 bg-orange-500 text-white text-[10px]\",children:unreadCount})]})]}),/*#__PURE__*/_jsx(TabsContent,{value:\"profile\",className:\"space-y-4 pt-4\",children:!showEditProfile?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(Label,{className:\"text-gray-400\",children:\"Username\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-200\",children:(user===null||user===void 0?void 0:user.username)||/*#__PURE__*/_jsx(\"span\",{className:\"italic text-gray-500\",children:\"(use seu UUID at\\xE9 definir um username)\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(Label,{className:\"text-gray-400\",children:\"UUID\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 truncate max-w-[140px]\",children:(user===null||user===void 0?void 0:user.uuid)||(user===null||user===void 0?void 0:user.id)}),/*#__PURE__*/_jsx(Button,{size:\"icon\",variant:\"ghost\",onClick:handleCopyId,className:\"h-6 w-6 text-gray-400 hover:text-white\",children:copied?/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4 text-green-400\"}):/*#__PURE__*/_jsx(Copy,{className:\"w-4 h-4\"})})]})]}),/*#__PURE__*/_jsxs(Button,{onClick:()=>setShowEditProfile(true),className:\"w-full bg-orange-500 hover:bg-orange-600\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4 mr-2\"}),\"Editar Perfil\"]})]}):/*#__PURE__*/_jsx(ProfileEdit,{userId:(authUser===null||authUser===void 0?void 0:authUser.uid)||(user===null||user===void 0?void 0:user.id),onClose:()=>setShowEditProfile(false)})}),/*#__PURE__*/_jsxs(TabsContent,{value:\"friends\",className:\"space-y-4 pt-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(Button,{variant:\"outline\",size:\"sm\",onClick:()=>setShowAddFriend(!showAddFriend),className:\"flex items-center gap-2 border-gray-700 text-gray-300 hover:bg-gray-800\",children:[/*#__PURE__*/_jsx(UserPlus,{className:\"w-4 h-4\"}),\"Adicionar Amigo\"]})}),/*#__PURE__*/_jsx(AnimatePresence,{children:showAddFriend&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:\"auto\"},exit:{opacity:0,height:0},className:\"overflow-hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 mt-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"friendId\",className:\"text-gray-300\",children:\"ID, UUID ou Username\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Input,{id:\"friendId\",value:friendId,onChange:e=>setFriendId(e.target.value),placeholder:\"Digite o identificador do amigo\",className:\"bg-gray-800 border-gray-700 text-white\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAddFriend,className:\"bg-orange-500 hover:bg-orange-600\",children:\"Enviar\"})]})]})})}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"destructive\",className:\"bg-red-900/20 border-red-800\",children:/*#__PURE__*/_jsx(AlertDescription,{className:\"text-xs\",children:error})}),success&&/*#__PURE__*/_jsx(Alert,{className:\"bg-green-900/20 border-green-800\",children:/*#__PURE__*/_jsx(AlertDescription,{className:\"text-xs text-green-400\",children:success})}),/*#__PURE__*/_jsx(FriendsList,{user:user})]}),/*#__PURE__*/_jsx(TabsContent,{value:\"messages\",className:\"pt-4\",children:/*#__PURE__*/_jsx(MessagesPanel,{user:user})})]}),/*#__PURE__*/_jsx(DropdownMenuSeparator,{className:\"bg-gray-800 my-4\"}),/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",onClick:async()=>{try{console.log('üö™ Usu√°rio clicou em logout...');// Limpar todos os caches\nqueryClient.clear();console.log('üßπ Cache limpo');await signOut();console.log('‚úÖ Logout conclu√≠do');// Aguardar um pouco para garantir que o estado seja atualizado\nsetTimeout(()=>{console.log('üîÑ Redirecionando para login...');window.location.href='/login';},100);}catch(error){console.error('‚ùå Erro no logout:',error);setError('Erro ao fazer logout: '+error.message);}},className:\"w-full justify-start text-red-400 hover:text-red-300 hover:bg-red-900/20\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4 mr-2\"}),\"Sair\"]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","DropdownMenu","DropdownMenuContent","DropdownMenuTrigger","DropdownMenuSeparator","Tabs","TabsContent","TabsList","TabsTrigger","Button","Input","Label","Avatar","AvatarFallback","User","Users","Copy","Check","UserPlus","LogOut","MessageSquare","Edit","motion","AnimatePresence","Alert","AlertDescription","Badge","MessagesPanel","FriendsList","ProfileEdit","signOut","userOperations","messageOperations","useNavigate","useQuery","useQueryClient","useAuthState","useUserProfile","jsx","_jsx","jsxs","_jsxs","UserMenu","authUser","profile","currentUser","loading","profileLoading","queryClient","friendId","setFriendId","showAddFriend","setShowAddFriend","showEditProfile","setShowEditProfile","showMessagesPanel","setShowMessagesPanel","copied","setCopied","error","setError","console","log","id","email","success","setSuccess","navigate","user","display_name","data","allUsernames","queryKey","queryFn","getAllUsernames","staleTime","gcTime","messages","getMessagesByRecipient","refetchInterval","enabled","unreadCount","filter","m","read","length","handleCopyId","idToCopy","username","uuid","navigator","clipboard","writeText","setTimeout","handleAddFriend","JSON","stringify","trim","searchInput","_user$friends","toLowerCase","searchLower","friendUsername","find","u","concat","uid","friends","includes","sendMessage","recipient_id","sender_id","sender_name","full_name","content","type","status","created_at","Date","toISOString","err","message","getInitials","name","split","map","n","join","toUpperCase","slice","displayUserName","children","asChild","variant","className","align","bio","role","defaultValue","onValueChange","value","size","onClick","userId","onClose","div","initial","opacity","height","animate","exit","htmlFor","onChange","e","target","placeholder","clear","window","location","href"],"sources":["C:/Users/Lucas Araujo/Desktop/supabase/DeckMaster/src/components/user/UserMenu.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuSeparator,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\r\nimport {\r\n  User,\r\n  Users,\r\n  Copy,\r\n  Check,\r\n  UserPlus,\r\n  LogOut,\r\n  MessageSquare,\r\n  Edit,\r\n} from \"lucide-react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport MessagesPanel from \"./MessagesPanel\";\r\nimport FriendsList from \"./FriendsList\";\r\nimport ProfileEdit from \"./ProfileEdit\";\r\n\r\nimport { signOut } from \"@/authSupabase\";\r\nimport { userOperations, messageOperations } from \"@/lib/supabaseOperations\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\r\nimport { useAuthState } from \"@/hooks/useAuthState\";\r\nimport { useUserProfile } from \"@/hooks/useUserProfile\";\r\n\r\nexport default function UserMenu() {\r\n  const [authUser] = useAuthState();\r\n  const { profile: currentUser, loading: profileLoading } = useUserProfile(authUser);\r\n  const queryClient = useQueryClient();\r\n  const [friendId, setFriendId] = useState(\"\");\r\n  const [showAddFriend, setShowAddFriend] = useState(false);\r\n  const [showEditProfile, setShowEditProfile] = useState(false);\r\n  const [showMessagesPanel, setShowMessagesPanel] = useState(false);\r\n  const [copied, setCopied] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  console.log('üîÑ UserMenu - authUser:', authUser);\r\n  console.log('üÜî UserMenu - authUser.id:', authUser?.id);\r\n  console.log('üîÑ UserMenu - authUser.email:', authUser?.email);\r\n  console.log('üë§ UserMenu - currentUser:', currentUser);\r\n  console.log('‚è≥ UserMenu - profileLoading:', profileLoading);\r\n  const [success, setSuccess] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // ‚úÖ Current User - Agora usando useUserProfile hook em vez de query antiga\r\n  // const { data: user } = useQuery({\r\n  //   queryKey: [\"currentUser\", auth.currentUser?.uid],\r\n  //   queryFn: async () => {\r\n  //     if (!auth.currentUser) return null;\r\n  //     const userRef = doc(db, \"users\", auth.currentUser.uid);\r\n  //     const docSnap = await getDoc(userRef);\r\n  //     return docSnap.exists() ? { id: docSnap.id, ...docSnap.data() } : null;\r\n  //   },\r\n  //   staleTime: 5 * 60 * 1000, // Cache 5 minutos\r\n  //   refetchInterval: 5 * 60 * 1000, // Polling a cada 5 minutos (ao inv√©s de tempo real)\r\n  //   enabled: !!auth.currentUser,\r\n  // });\r\n\r\n  // Usar currentUser do hook useUserProfile\r\n  const user = currentUser;\r\n  console.log('üéØ UserMenu - user final:', user);\r\n  console.log('üîç UserMenu - display_name:', user?.display_name);\r\n  console.log('üîç UserMenu - email:', user?.email);\r\n\r\n  // Buscar usernames da tabela 'usernames'\r\n  const { data: allUsernames = [] } = useQuery({\r\n    queryKey: [\"allUsernames\"],\r\n    queryFn: async () => {\r\n      return await userOperations.getAllUsernames();\r\n    },\r\n    staleTime: 30 * 60 * 1000, // Cache 30 minutos\r\n    gcTime: 60 * 60 * 1000, // Garbage collect ap√≥s 1 hora\r\n  });\r\n\r\n  // ‚úÖ Messages - S√≥ busca quando painel est√° ABERTO (economia de ~3.600 leituras/hora quando fechado)\r\n  const { data: messages = [] } = useQuery({\r\n    queryKey: [\"messages\", user?.id],\r\n    queryFn: async () => {\r\n      if (!user?.id) return [];\r\n      return await messageOperations.getMessagesByRecipient(user.id);\r\n    },\r\n    staleTime: 2 * 60 * 1000, // Cache 2 minutos\r\n    refetchInterval: showMessagesPanel ? 30 * 1000 : false, // Polling apenas quando painel aberto\r\n    enabled: !!user?.id && showMessagesPanel, // S√ì busca se painel est√° aberto\r\n  });\r\n\r\n  const unreadCount = messages.filter((m) => !m.read).length;\r\n\r\n  const handleCopyId = () => {\r\n    const idToCopy = user?.username || user?.uuid || user?.id;\r\n    if (idToCopy) {\r\n      navigator.clipboard.writeText(idToCopy);\r\n      setCopied(true);\r\n      setTimeout(() => setCopied(false), 2000);\r\n    }\r\n  };\r\n\r\n  const handleAddFriend = async () => {\r\n  console.log('[DEBUG] allUsernames:', JSON.stringify(allUsernames, null, 2));\r\n  console.log('[DEBUG] searchInput:', friendId.trim());\r\n    setError(null);\r\n    setSuccess(null);\r\n    const searchInput = friendId.trim();\r\n    if (!searchInput) {\r\n      setError(\"Por favor, insira um ID ou username\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('[DEBUG] Tentando encontrar usu√°rio:', {\r\n        id: friendId.trim(),\r\n        username: friendId.trim().toLowerCase()\r\n      });\r\n      const searchLower = searchInput.toLowerCase();\r\n      const friendUsername = allUsernames.find((u) => u.id.toLowerCase() === searchLower);\r\n      console.log('[DEBUG] Resultado friendUsername:', friendUsername);\r\n\r\n      if (!friendUsername) {\r\n        setError(`Usu√°rio n√£o encontrado: \"${searchInput}\"`);\r\n        return;\r\n      }\r\n\r\n      if (friendUsername.uid === user.id) {\r\n        setError(\"Voc√™ n√£o pode adicionar a si mesmo\");\r\n        return;\r\n      }\r\n\r\n      if (user.friends?.includes(friendUsername.uid)) {\r\n        setError(\"Este usu√°rio j√° est√° na sua lista de amigos\");\r\n        return;\r\n      }\r\n\r\n      await messageOperations.sendMessage({\r\n        recipient_id: friendUsername.uid,\r\n        sender_id: user.id,\r\n        sender_name: user.display_name || user.full_name || user.email,\r\n        content: `${user.display_name || user.full_name || user.email} quer adicionar voc√™ como amigo.`,\r\n        type: \"friend_request\",\r\n        status: \"pending\",\r\n        created_at: new Date().toISOString(),\r\n      });\r\n\r\n      setSuccess(\"Solicita√ß√£o de amizade enviada com sucesso!\");\r\n      setFriendId(\"\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError(`Erro: ${err.message || \"N√£o foi poss√≠vel enviar a solicita√ß√£o\"}`);\r\n    }\r\n  };\r\n\r\n  const getInitials = (name) => {\r\n    if (!name) return \"U\";\r\n    return name\r\n      .split(\" \")\r\n      .map((n) => n[0])\r\n      .join(\"\")\r\n      .toUpperCase()\r\n      .slice(0, 2);\r\n  };\r\n\r\n  const displayUserName = user?.display_name || user?.full_name;\r\n\r\n  return (\r\n    <DropdownMenu>\r\n      <DropdownMenuTrigger asChild>\r\n        <Button\r\n          variant=\"ghost\"\r\n          className=\"relative h-10 w-10 rounded-full border-2 border-gray-700 hover:border-orange-500 transition-colors\"\r\n        >\r\n          {unreadCount > 0 && (\r\n            <Badge className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 bg-orange-500 text-white text-xs\">\r\n              {unreadCount}\r\n            </Badge>\r\n          )}\r\n          <Avatar className=\"h-9 w-9\">\r\n            <AvatarFallback className=\"bg-gradient-to-br from-orange-500 to-purple-600 text-white font-semibold\">\r\n              {getInitials(displayUserName || user?.email)}\r\n            </AvatarFallback>\r\n          </Avatar>\r\n        </Button>\r\n      </DropdownMenuTrigger>\r\n\r\n      <DropdownMenuContent\r\n        className=\"w-96 bg-gray-900 border-gray-800 text-white p-4\"\r\n        align=\"end\"\r\n      >\r\n        {/* User Info */}\r\n        <div className=\"flex items-start gap-3 mb-4\">\r\n          <Avatar className=\"h-12 w-12\">\r\n            <AvatarFallback className=\"bg-gradient-to-br from-orange-500 to-purple-600 text-white font-semibold text-lg\">\r\n              {getInitials(displayUserName || user?.email)}\r\n            </AvatarFallback>\r\n          </Avatar>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <p className=\"font-semibold text-white truncate\">{displayUserName}</p>\r\n            <p className=\"text-sm text-gray-400 truncate\">{user?.email}</p>\r\n            {user?.bio && (\r\n              <p className=\"text-xs text-gray-500 mt-1 line-clamp-2\">{user.bio}</p>\r\n            )}\r\n            {user?.role === \"admin\" && (\r\n              <span className=\"inline-block mt-1 px-2 py-0.5 bg-orange-500/20 text-orange-400 text-xs rounded-full\">\r\n                Admin\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <DropdownMenuSeparator className=\"bg-gray-800 mb-4\" />\r\n\r\n        {/* Tabs */}\r\n        <Tabs \r\n          defaultValue=\"profile\" \r\n          className=\"w-full\"\r\n          onValueChange={(value) => {\r\n            // Ativa busca de mensagens APENAS quando aba √© aberta\r\n            setShowMessagesPanel(value === \"messages\");\r\n          }}\r\n        >\r\n          <TabsList className=\"grid w-full grid-cols-3 bg-gray-800\">\r\n            <TabsTrigger value=\"profile\" className=\"data-[state=active]:bg-gray-700\">\r\n              <User className=\"w-4 h-4 mr-1\" />\r\n              Perfil\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"friends\" className=\"data-[state=active]:bg-gray-700\">\r\n              <Users className=\"w-4 h-4 mr-1\" />\r\n              Amigos\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"messages\"\r\n              className=\"data-[state=active]:bg-gray-700 relative\"\r\n            >\r\n              <MessageSquare className=\"w-4 h-4 mr-1\" />\r\n              Mensagens\r\n              {unreadCount > 0 && (\r\n                <Badge className=\"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 bg-orange-500 text-white text-[10px]\">\r\n                  {unreadCount}\r\n                </Badge>\r\n              )}\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n                    {/* Perfil */}\r\n          <TabsContent value=\"profile\" className=\"space-y-4 pt-4\">\r\n            {!showEditProfile ? (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <Label className=\"text-gray-400\">Username</Label>\r\n                  <span className=\"text-sm text-gray-200\">\r\n                    {user?.username || (\r\n                      <span className=\"italic text-gray-500\">\r\n                        (use seu UUID at√© definir um username)\r\n                      </span>\r\n                    )}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex items-center justify-between\">\r\n                  <Label className=\"text-gray-400\">UUID</Label>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xs text-gray-500 truncate max-w-[140px]\">\r\n                      {user?.uuid || user?.id}\r\n                    </span>\r\n                    <Button\r\n                      size=\"icon\"\r\n                      variant=\"ghost\"\r\n                      onClick={handleCopyId}\r\n                      className=\"h-6 w-6 text-gray-400 hover:text-white\"\r\n                    >\r\n                      {copied ? (\r\n                        <Check className=\"w-4 h-4 text-green-400\" />\r\n                      ) : (\r\n                        <Copy className=\"w-4 h-4\" />\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <Button\r\n                  onClick={() => setShowEditProfile(true)}\r\n                  className=\"w-full bg-orange-500 hover:bg-orange-600\"\r\n                >\r\n                  <Edit className=\"w-4 h-4 mr-2\" />\r\n                  Editar Perfil\r\n                </Button>\r\n              </div>\r\n            ) : (\r\n              <ProfileEdit\r\n                userId={authUser?.uid || user?.id}\r\n                onClose={() => setShowEditProfile(false)}\r\n              />\r\n            )}\r\n          </TabsContent>\r\n\r\n          {/* Amigos */}\r\n          <TabsContent value=\"friends\" className=\"space-y-4 pt-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setShowAddFriend(!showAddFriend)}\r\n                className=\"flex items-center gap-2 border-gray-700 text-gray-300 hover:bg-gray-800\"\r\n              >\r\n                <UserPlus className=\"w-4 h-4\" />\r\n                Adicionar Amigo\r\n              </Button>\r\n            </div>\r\n\r\n            <AnimatePresence>\r\n              {showAddFriend && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, height: 0 }}\r\n                  animate={{ opacity: 1, height: \"auto\" }}\r\n                  exit={{ opacity: 0, height: 0 }}\r\n                  className=\"overflow-hidden\"\r\n                >\r\n                  <div className=\"space-y-2 mt-2\">\r\n                    <Label htmlFor=\"friendId\" className=\"text-gray-300\">\r\n                      ID, UUID ou Username\r\n                    </Label>\r\n                    <div className=\"flex gap-2\">\r\n                      <Input\r\n                        id=\"friendId\"\r\n                        value={friendId}\r\n                        onChange={(e) => setFriendId(e.target.value)}\r\n                        placeholder=\"Digite o identificador do amigo\"\r\n                        className=\"bg-gray-800 border-gray-700 text-white\"\r\n                      />\r\n                      <Button\r\n                        onClick={handleAddFriend}\r\n                        className=\"bg-orange-500 hover:bg-orange-600\"\r\n                      >\r\n                        Enviar\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {error && (\r\n              <Alert variant=\"destructive\" className=\"bg-red-900/20 border-red-800\">\r\n                <AlertDescription className=\"text-xs\">{error}</AlertDescription>\r\n              </Alert>\r\n            )}\r\n            {success && (\r\n              <Alert className=\"bg-green-900/20 border-green-800\">\r\n                <AlertDescription className=\"text-xs text-green-400\">\r\n                  {success}\r\n                </AlertDescription>\r\n              </Alert>\r\n            )}\r\n\r\n            <FriendsList user={user} />\r\n          </TabsContent>\r\n\r\n          {/* Mensagens */}\r\n          <TabsContent value=\"messages\" className=\"pt-4\">\r\n            <MessagesPanel user={user} />\r\n          </TabsContent>\r\n        </Tabs>\r\n\r\n        <DropdownMenuSeparator className=\"bg-gray-800 my-4\" />\r\n\r\n        {/* Bot√£o Sair */}\r\n        <Button\r\n          variant=\"ghost\"\r\n          onClick={async () => {\r\n            try {\r\n              console.log('üö™ Usu√°rio clicou em logout...');\r\n              \r\n              // Limpar todos os caches\r\n              queryClient.clear();\r\n              console.log('üßπ Cache limpo');\r\n              \r\n              await signOut();\r\n              console.log('‚úÖ Logout conclu√≠do');\r\n              \r\n              // Aguardar um pouco para garantir que o estado seja atualizado\r\n              setTimeout(() => {\r\n                console.log('üîÑ Redirecionando para login...');\r\n                window.location.href = '/login';\r\n              }, 100);\r\n              \r\n            } catch (error) {\r\n              console.error('‚ùå Erro no logout:', error);\r\n              setError('Erro ao fazer logout: ' + error.message);\r\n            }\r\n          }}\r\n          className=\"w-full justify-start text-red-400 hover:text-red-300 hover:bg-red-900/20\"\r\n        >\r\n          <LogOut className=\"w-4 h-4 mr-2\" />\r\n          Sair\r\n        </Button>\r\n      </DropdownMenuContent>\r\n    </DropdownMenu>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}